<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReqMaster - æ™ºèƒ½éœ€æ±‚åˆ†æå¹³å°</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 2rem;
        }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 2rem;
        }
        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 2rem 0;
        }
        .feature-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
            border: none;
            cursor: pointer;
        }
        .btn-secondary {
            background: #6c757d;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
            display: block;
        }
        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        .status-success { color: #28a745; }
        .status-error { color: #dc3545; }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>ReqMaster</h1>
        <p>æ™ºèƒ½éœ€æ±‚åˆ†æä¸ç®¡ç†å¹³å° - åŸºäºå¤§æ¨¡å‹çš„ç°ä»£åŒ–éœ€æ±‚å·¥ç¨‹è§£å†³æ–¹æ¡ˆ</p>
    </header>

    <div class="dashboard">
        <div class="card">
            <h3>ç³»ç»Ÿæ¦‚è§ˆ</h3>
            <div class="stats">
                <div>
                    <span class="stat-number" id="projectCount">0</span>
                    <span class="stat-label">é¡¹ç›®æ•°é‡</span>
                </div>
                <div>
                    <span class="stat-number" id="requirementCount">0</span>
                    <span class="stat-label">éœ€æ±‚æ•°é‡</span>
                </div>
                <div>
                    <span class="stat-number" id="sessionCount">0</span>
                    <span class="stat-label">å¯¹è¯ä¼šè¯</span>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>å¿«é€Ÿå¼€å§‹</h3>
            <p>é€‰æ‹©ä»¥ä¸‹åŠŸèƒ½å¼€å§‹ä½¿ç”¨ ReqMasterï¼š</p>
            <div style="margin-top: 1rem;">
                <a href="/reqmaster/swagger-ui.html" class="btn" target="_blank">API æ–‡æ¡£</a>
                <button class="btn btn-secondary" onclick="createSampleProject()">åˆ›å»ºç¤ºä¾‹é¡¹ç›®</button>
                <button class="btn" onclick="testAllAPIs()">å…¨é¢åŠŸèƒ½æµ‹è¯•</button>
            </div>
        </div>
    </div>

    <h2>æ ¸å¿ƒåŠŸèƒ½</h2>
    <div class="features">
        <div class="feature-card">
            <h3>ğŸ“ æ™ºèƒ½éœ€æ±‚åˆ†æ</h3>
            <p>ä½¿ç”¨AIæŠ€æœ¯è‡ªåŠ¨åˆ†æå’Œæ•´ç†éœ€æ±‚ï¼Œè¯†åˆ«çŸ›ç›¾å’Œä¸å®Œæ•´ä¹‹å¤„</p>
        </div>
        <div class="feature-card">
            <h3>ğŸ” æ–‡æ¡£è§£æ</h3>
            <p>è‡ªåŠ¨è§£æWordã€PDFç­‰æ ¼å¼çš„éœ€æ±‚æ–‡æ¡£ï¼Œæå–ç»“æ„åŒ–ä¿¡æ¯</p>
        </div>
        <div class="feature-card">
            <h3>ğŸ’¬ æ™ºèƒ½å¯¹è¯</h3>
            <p>ä¸AIéœ€æ±‚åˆ†æå¸ˆè¿›è¡Œè‡ªç„¶è¯­è¨€å¯¹è¯ï¼Œæ¾„æ¸…éœ€æ±‚ç»†èŠ‚</p>
        </div>
        <div class="feature-card">
            <h3>ğŸ“Š ç”¨æˆ·æ•…äº‹ç”Ÿæˆ</h3>
            <p>è‡ªåŠ¨ç”Ÿæˆç¬¦åˆINVESTåŸåˆ™çš„ç”¨æˆ·æ•…äº‹å’ŒéªŒæ”¶æ ‡å‡†</p>
        </div>
        <div class="feature-card">
            <h3>âœ… ä¸€è‡´æ€§æ£€æŸ¥</h3>
            <p>æ£€æµ‹éœ€æ±‚ä¹‹é—´çš„é€»è¾‘çŸ›ç›¾å’Œä¾èµ–å…³ç³»</p>
        </div>
        <div class="feature-card">
            <h3>ğŸ“ˆ éœ€æ±‚ç®¡ç†</h3>
            <p>å®Œæ•´çš„é¡¹ç›®ç®¡ç†ã€éœ€æ±‚è·Ÿè¸ªå’Œç‰ˆæœ¬æ§åˆ¶</p>
        </div>
    </div>

    <div id="testResult" style="margin-top: 20px;"></div>

    <div style="text-align: center; margin-top: 2rem;">
        <h3>å¼€å‘æ¥å£</h3>
        <p>ä½¿ç”¨ä»¥ä¸‹é“¾æ¥è®¿é—®ç³»ç»Ÿçš„REST APIæ¥å£ï¼š</p>
        <div>
            <a href="/reqmaster/swagger-ui.html" class="btn" target="_blank">Swagger UI</a>
            <a href="/reqmaster/api-docs" class="btn btn-secondary" target="_blank">OpenAPI è§„èŒƒ</a>
            <a href="/reqmaster/api/projects" class="btn" target="_blank">é¡¹ç›®ç®¡ç†API</a>
        </div>
    </div>

    <footer style="text-align: center; margin-top: 3rem; padding: 2rem 0; color: #666; border-top: 1px solid #e9ecef;">
        <p>ReqMaster &copy; 2024 - æ™ºèƒ½éœ€æ±‚åˆ†æå¹³å° | åŸºäºSpring Bootå’ŒDeepSeekç­‰å¤§æ¨¡å‹æŠ€æœ¯</p>
        <p style="margin-top: 0.5rem; font-size: 0.9rem;">
            æŠ€æœ¯æ ˆ: Java 17, Spring Boot 3, MySQL, Redis, DeepSeek API
        </p>
    </footer>
</div>

<script>
    // åŠ è½½ä»ªè¡¨æ¿æ•°æ®
    async function loadDashboardData() {
        try {
            const response = await fetch('/reqmaster/api/dashboard');
            const data = await response.json();

            if (data.success) {
                const dashboard = data.data;
                document.getElementById('projectCount').textContent = dashboard.totalProjects || 0;
                document.getElementById('requirementCount').textContent = dashboard.totalRequirements || 0;
                document.getElementById('sessionCount').textContent = dashboard.totalChatSessions || 0;
            }
        } catch (error) {
            console.log('ä»ªè¡¨æ¿æ•°æ®åŠ è½½å¤±è´¥ï¼Œç³»ç»Ÿå¯èƒ½è¿˜æ²¡æœ‰æ•°æ®');
        }
    }

    // åˆ›å»ºç¤ºä¾‹é¡¹ç›®
    async function createSampleProject() {
        const resultDiv = document.getElementById('testResult');
        try {
            resultDiv.innerHTML = '<div class="card">æ­£åœ¨åˆ›å»ºç¤ºä¾‹é¡¹ç›®...</div>';

            const response = await fetch('/reqmaster/api/projects', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: 'æ™ºèƒ½ç”µå•†å¹³å°ç¤ºä¾‹',
                    description: 'è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ç”µå•†å¹³å°é¡¹ç›®ï¼Œç”¨äºæ¼”ç¤ºReqMasterçš„åŠŸèƒ½',
                    domain: 'ç”µå•†'
                })
            });

            const data = await response.json();
            if (data.success) {
                resultDiv.innerHTML =
                    `<div class="card status-success">
                            <h3>âœ… ç¤ºä¾‹é¡¹ç›®åˆ›å»ºæˆåŠŸï¼</h3>
                            <p>é¡¹ç›®ID: ${data.data.id}</p>
                            <p>é¡¹ç›®åç§°: ${data.data.name}</p>
                            <p>ç°åœ¨æ‚¨å¯ä»¥å¼€å§‹ä½“éªŒReqMasterçš„å„é¡¹åŠŸèƒ½</p>
                         </div>`;
                loadDashboardData(); // åˆ·æ–°æ•°æ®
            } else {
                resultDiv.innerHTML =
                    `<div class="card status-error">
                            <h3>âŒ åˆ›å»ºå¤±è´¥</h3>
                            <p>é”™è¯¯ä¿¡æ¯: ${data.message}</p>
                         </div>`;
            }
        } catch (error) {
            resultDiv.innerHTML =
                `<div class="card status-error">
                        <h3>âŒ è¯·æ±‚å¤±è´¥</h3>
                        <p>å¼‚å¸¸ä¿¡æ¯: ${error}</p>
                     </div>`;
        }
    }

    // å…¨é¢åŠŸèƒ½æµ‹è¯•
    async function testAllAPIs() {
        const resultDiv = document.getElementById('testResult');
        resultDiv.innerHTML = '<div class="card">å¼€å§‹å…¨é¢åŠŸèƒ½æµ‹è¯•...</div>';

        const tests = [
            { name: 'å¥åº·æ£€æŸ¥', url: '/reqmaster/actuator/health', method: 'GET' },
            { name: 'é¡¹ç›®åˆ—è¡¨', url: '/reqmaster/api/projects', method: 'GET' },
            { name: 'åˆ›å»ºé¡¹ç›®', url: '/reqmaster/api/projects', method: 'POST',
                body: { name: 'æµ‹è¯•é¡¹ç›®-' + Date.now(), description: 'åŠŸèƒ½æµ‹è¯•', domain: 'æµ‹è¯•' }},
            { name: 'ä»ªè¡¨æ¿æ•°æ®', url: '/reqmaster/api/dashboard', method: 'GET' }
        ];

        let results = [];

        for (const test of tests) {
            try {
                const options = {
                    method: test.method,
                    headers: { 'Content-Type': 'application/json' }
                };

                if (test.body) {
                    options.body = JSON.stringify(test.body);
                }

                const response = await fetch(test.url, options);
                const data = await response.ok ? await response.json() : null;

                results.push({
                    name: test.name,
                    success: response.ok,
                    status: response.status
                });

                resultDiv.innerHTML =
                    `<div class="card">
                            <h3>åŠŸèƒ½æµ‹è¯•è¿›åº¦</h3>
                            <ul>
                                ${results.map(r =>
                        `<li>${r.name}: ${r.success ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'} (${r.status})</li>`
                    ).join('')}
                            </ul>
                         </div>`;

            } catch (error) {
                results.push({
                    name: test.name,
                    success: false,
                    status: 'ERROR'
                });
            }
        }

        const allPassed = results.every(r => r.success);
        resultDiv.innerHTML +=
            `<div class="card ${allPassed ? 'status-success' : 'status-error'}">
                    <h3>${allPassed ? 'ğŸ‰ æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡ï¼' : 'âš ï¸ éƒ¨åˆ†åŠŸèƒ½æµ‹è¯•å¤±è´¥'}</h3>
                    <p>å…±æµ‹è¯• ${results.length} ä¸ªæ¥å£ï¼Œ${results.filter(r => r.success).length} ä¸ªæˆåŠŸ</p>
                 </div>`;
    }

    // é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
    document.addEventListener('DOMContentLoaded', function() {
        loadDashboardData();
    });
</script>
</body>
</html>